#! Generated using commit GITCOMMIT
# A test of DSRG-MRPT2 gradient on H2O with c1 symmetry

import forte

ref_grad = psi4.Matrix.from_list([ 
      [-0.000000000000, -0.000000000000,  0.031024471677],
      [-0.000000000000,  0.028795168777, -0.015512235838],
      [ 0.000000000000, -0.028795168777, -0.015512235838]
      ])

molecule {
O
H             1    0.956022
H             1    0.956022      2  104.155814
symmetry c1
}

set {
  basis 				3-21g
  reference 			rhf
  scf_type 				pk
  e_convergence 		10
  d_convergence 		10
  mcscf_type            conv
  mcscf_maxiter         100
  mcscf_diis_start      20
  MCSCF_E_CONVERGENCE   12
  MCSCF_R_CONVERGENCE   10
}

set scf_type direct

set forte {
  active_space_solver 	fci
  correlation_solver 	dsrg-mrpt2
  restricted_docc 		[4]
  active          		[1]
  restricted_uocc 		[8]
  dsrg_s 				1.0
  dsrgpt               	true
  print_denom2         	true
  multiplicity         	1
}

grad = gradient('forte')

compare_matrices(ref_grad, grad, 7, "DSRG-MRPT2 gradient on H2O with c1 symmetry") 
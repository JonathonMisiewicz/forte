#! Generated using commit GITCOMMIT
# A test of DSRG-MRPT2 gradient on HF with default symmetry

import forte

ref_grad = psi4.Matrix.from_list([ 
      [ 0.000000000000,  0.000000000000,  0.167706019971],
      [ 0.000000000000,  0.000000000000, -0.167706019971]
      ])


molecule HF {
0 3
H
F 1 1.3
}

set {
	basis 				 3-21g
	reference 			 rohf
	scf_type 			 pk
	e_convergence 		 10
	d_convergence 		 10
	docc 				 [2,0,1,1]
	socc 				 [2,0,0,0]
	mcscf_type           conv
	mcscf_maxiter        100
	mcscf_diis_start     20
	MCSCF_E_CONVERGENCE  12
	MCSCF_R_CONVERGENCE  10
}


set scf_type direct

set forte {
	active_space_solver   cas
	correlation_solver    dsrg-mrpt2
	restricted_docc 	  [2,0,1,1]
	active 				  [2,0,0,0]
	dsrg_s 				  1.0
	dsrgpt                true
	print_denom2          true
	multiplicity          3 
}

grad = gradient('forte')

compare_matrices(ref_grad, grad, 7, "DSRG-MRPT2 gradient on HF with default symmetry")  


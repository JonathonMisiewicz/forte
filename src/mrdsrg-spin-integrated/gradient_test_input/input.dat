#! Generated using commit GITCOMMIT

import forte

molecule {
  0 1
  Be        0.000000000000     0.000000000000     0.000000000000
  H         0.000000000000     1.390000000000     0.300000000000
  H         0.000000000000    -1.390000000000     0.300000000000
  no_reorient
}

set globals{
   scf_type             pk
   d_convergence        12
   e_convergence        15
   basis                3-21g

   restricted_docc      [2,0,0,0]
   active               [1,0,0,1]

   maxiter              100
   reference            RHF
   mcscf_type           conv
   mcscf_maxiter        100
   mcscf_diis_start     20
   MCSCF_E_CONVERGENCE  8
   MCSCF_R_CONVERGENCE  6
}


set mcscf{
   reference            twocon
   docc                 [2,0,0,0]
   socc                 [1,0,0,1]
   maxiter              1000
}

set forte{
   active_space_solver  fci
   correlation_solver   dsrg-mrpt2
   restricted_docc      [2,0,0,0]
   active               [1,0,0,1]
   root_sym             0
   nroot                1
   dsrg_s               1.0
   dsrgpt               true
   print_denom2         true
   multiplicity         1 
}



scf_energy, wfn = energy('casscf', return_wfn=True)
#compare_values(refmcscf,variable("CURRENT ENERGY"),10,"MCSCF energy") #TEST

# energy('forte',ref_wfn=wfn)
gradient('forte',ref_wfn=wfn)
#compare_values(refdsrgpt2,variable("CURRENT ENERGY"),10,"DSRG-MRPT2 energy") #TEST


# set findif{ 
#   points 5
# }
# gradient('forte',ref_wfn=wfn,dertype='energy')

